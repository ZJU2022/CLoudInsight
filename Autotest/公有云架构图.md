# 公有云架构图

## 架构说明

本架构图展示了公有云的分层设计，从最终用户层到底层物理资源，每层都有明确的职责和测试重点。中台层作为核心支撑，提供计费、账号、监控、审计等关键服务，确保整个云平台的稳定运营。（供参考：例如k8s理论上应该放在Iaas）

## 架构分层图

```
┌───────────────────────────────────────────────────────────────────────────────────────┐
│                          最终用户层 (End Users & Tenants)                              │
│                        (使用云服务的客户或内部用户)                                      │
└───────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           │ (通过 Portal/Console/API 使用服务)
                                           ▼
┌───────────────────────────────────────────────────────────────────────────────────────┐
│                                    SaaS (Software as a Service)                       │
│                              [直接提供可消费的应用/服务]                                 │
├─────────────────────┬─────────────────────┬─────────────────────┬─────────────────────┤
│   用户应用           │   管理门户/控制台     │   API 市场/服务目录   │   其他 SaaS 服务    │
│  (CRM, ERP...)      │   (Portal)         │   (API Market)      │   (其他应用)        │
├─────────────────────┴─────────────────────┴─────────────────────┴─────────────────────┤
│ 测试点: 最终业务功能、UI/UX、API、租户隔离                                                │
└───────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           │ (服务编排、配置、监控)
                                           │ (依赖中台能力)
                                           ▼
┌═══════════════════════════════════════════════════════════════════════════════════════┐
│                          中台层 (Middleware / Shared Services)                        │
│                [为云平台自身提供统一、可复用的管理和运营支撑能力]                           │
├─────────────────┬─────────────────┬─────────────────┬─────────────────┬───────────────┤
│   计费系统       │   账号系统       │  监控告警系统    │  审计日志系统     │  其他中台服务   │
│   (Billing)     │   (IAM)        │ (Monitoring)   │ (Audit Log)     │              │
├─────────────────┼─────────────────┼─────────────────┼─────────────────┼───────────────┤
│ • 计量数据输入    │ • 认证授权       │ • 指标/日志采集   │ • 操作记录        │ • 配置管理     │
│ • 计费指令       │ • 策略下发       │ • 告警触发       │ • 日志查询        │ • 服务发现     │
│ • 资源计量数据    │ • 访问控制令牌   │ • 监控数据消费   │ • 合规检查        │ • 消息总线     │
└─────────────────┴─────────────────┴─────────────────┴─────────────────┴───────────────┘
└═══════════════════════════════════════════════════════════════════════════════════════┘
                                           │
                                           │ (用量、权限、状态、操作、日志)
                                           ▼
┌───────────────────────────────────────────────────────────────────────────────────────┐
│                                    PaaS (Platform as a Service)                       │
│                              [提供可消费的平台服务]                                     │
├─────────────────┬─────────────────┬─────────────────┬─────────────────┬───────────────┤
│  Kubernetes     │   数据库服务     │   消息队列       │  函数计算        │  其他 PaaS     │
│  (Master/Node)  │ (MySQL/PG/...) │ (MQ/RabbitMQ)   │   (FaaS)        │   服务        │
├─────────────────┼─────────────────┼─────────────────┼─────────────────┼───────────────┤
│ • 容器编排       │ • 关系型数据库    │ • 消息传递       │ • 事件驱动       │ • 缓存服务     │
│ • 服务发现       │ • NoSQL 数据库   │ • 异步处理       │ • 无服务器       │ • 搜索服务     │
│ • 自动扩缩容     │ • 数据备份       │ • 解耦架构       │ • 按需计费       │ • 流处理       │
└─────────────────┴─────────────────┴─────────────────┴─────────────────┴───────────────┘
└───────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           │ (资源、存储/网络、计算事件)
                                           ▼
┌───────────────────────────────────────────────────────────────────────────────────────┐
│                                    IaaS (Infrastructure as a Service)                 │
│                              [提供基础计算、存储、网络资源]                               │
├─────────────────┬─────────────────┬─────────────────┬─────────────────┬───────────────┤
│   主机 (UHost)   │  虚拟网络 (VPC)  │  块存储/对象存储  │  负载均衡        │  其他 IaaS     │
│     (VM)        │ (子网/路由/ACL)  │ (云盘/EBS/S3)   │   (ELB)         │   服务        │
├─────────────────┼─────────────────┼─────────────────┼─────────────────┼───────────────┤
│ • 虚拟机实例     │ • 私有网络       │ • 块存储         │ • 流量分发       │ • 弹性伸缩     │
│ • 计算资源       │ • 子网划分       │ • 对象存储       │ • 健康检查       │ • 安全组       │
│ • 操作系统       │ • 路由配置       │ • 文件存储       │ • 会话保持       │ • 密钥管理     │
└─────────────────┴─────────────────┴─────────────────┴─────────────────┴───────────────┘
└───────────────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           │ (虚拟化抽象、驱动、内核调度)
                                           ▼
┌───────────────────────────────────────────────────────────────────────────────────────┐
│                              物理层 & 内核层                                            │
│                    (物理服务器、Hypervisor、Host OS Kernel)                             │
├───────────────────────────────────────────────────────────────────────────────────────┤
│ • 物理服务器硬件   │ • 虚拟化技术      │ • 操作系统内核    │ • 设备驱动        │ • 网络栈        │
│ • CPU/内存/存储   │ • 资源隔离        │ • 进程调度        │ • 存储驱动        │ • 安全模块       │
│ • 网络设备        │ • 内存管理        │ • 文件系统        │ • 网络驱动        │ • 监控代理       │
└───────────────────────────────────────────────────────────────────────────────────────┘
└───────────────────────────────────────────────────────────────────────────────────────┘
```
