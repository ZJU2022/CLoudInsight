# 自动化设计思路

## 自动化目的
- 提高效率，降低缺陷

## 自动化本质
自动化是在质量、成本、效率之间作出一个抉择；针对不同场景对于这三角有不同的偏好，有些场景如新上一个地域的《回归测试》需要效率优先，全量回归以覆盖全部场景保证质量优先；需要针对不同的场景给出不同的测试方案，自动化在里面更多是扮演一个提效以及复用的角色。

## 分层自动化设计

### 第一层：业务层（黑盒测试）
- 覆盖用户使用场景，以及各个功能模块的细化场景（梳理，实现自动化，设计时覆盖异常场景/边界/等价）
- 本质是接口的连续调用以及CRUD
- 以及不同的数据驱动同样的接口调用
- 设计时尽量降低维护成本和使用成本

### 第二层：服务层（灰盒测试）
- 了解微服务架构（确定每次自动化都覆盖了改动的微服务）
- 服务依赖图谱：通过工具（如Jaeger、Zipkin）生成微服务依赖图，明确每次变更涉及的具体服务
- 契约测试：在服务之间加入契约测试（Contract Testing），提前发现上下游服务的集成问题

### 第三层：代码层（白盒测试）
- 了解代码逻辑（确认自动化覆盖代码分支，白盒测试，review代码，代码覆盖率工具）
- 量化指标
  - 对代码覆盖率目标做出明确定义（如 80%-90%），并结合实际项目调整
  - 补充静态代码分析工具（如 SonarQube）的使用，以发现潜在问题

### 平行层（非必需）
- 组件测试，技术架构中有Redis，测试Redis的可用性等
- 性能自动化：针对关键路径添加性能测试脚本，评估并发能力和响应时间。如iperf打流，容灾演练
- 安全自动化：在常见漏洞（如SQL注入、XSS）层面增加安全测试脚本，预检查失败等

## 补充要点

### 1. ROI + 项目文档
衡量自动化投入产出比，ROI计算方式：自动化提高效率以及拦截缺陷避免的资损/开发与维护投入人力成本
- 明确提高的效率，如50%
- 明确自动化拦截的P0缺陷以及避免的资损，如3次P0，10次P1，500W
- 明确投入的成本：60h/人/期 + 维护成本5h/人/月

### 2. 缺陷追踪
使用缺陷管理工具定期分析历史缺陷，从中提取哪些场景需要重点关注自动化覆盖。

### 3. 定期评估
定期审视已有的自动化用例库，确认是否存在冗余、过时或未覆盖的关键场景。

### 4. 定时巡检（拨测）
接入定时运行自动化，自动告警：如1h/次。定时运行记得评估每月自动化成本。

### 5. 量化指标
在自动化推行的每一层引入一些核心可量化指标。

### 6. 数据驱动
每一层数据驱动方式不同，需注意。

### 7. 发展趋势
关注测试行业最新动态，未来发展趋势的思考，如基于 AI 的自动化测试生成或动态优化。

### 8. 团队协作
明确开发人，维护人，负责人，落实责任，负责人要对于所有东西都了如指掌，分给组员是为了节约时间。 